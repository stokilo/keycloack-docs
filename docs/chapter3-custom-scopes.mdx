---
sidebar_label: 'Custom scopes'
sidebar_position: 103
---

import SwiperImageCarousel from './components/SwiperImageCarousel';
import ShikiCodeBlock from './components/ShikiCodeBlock';
import Highlight from './components/Highlight';

# Resource Server

**Chapter 3**


**How to define custom client scopes in Keycloak**

Create new Realm **spring-boot-exercise**

Realm config details: [Realm](Realm.html)

**Configure Client and Client Scopes**

<SwiperImageCarousel
  images={[
    { src: '/img/chapter3/screenshot_11ddsGERb.png', alt: 'Screenshot 1' },
    { src: '/img/chapter3/screenshot_22c1nuUrl.png', alt: 'Screenshot 2' },
    { src: '/img/chapter3/screenshot_33ZzCXGUE.png', alt: 'Screenshot 3' },
    { src: '/img/chapter3/screenshot_447UGmIeV.png', alt: 'Screenshot 4' },
    { src: '/img/chapter3/screenshot_55d8HtBGB.png', alt: 'Screenshot 5' },
    { src: '/img/chapter3/screenshot_66q66wlPn.png', alt: 'Screenshot 6' },
    { src: '/img/chapter3/screenshot_77pYF0PmX.png', alt: 'Screenshot 7' },
  ]} />

**Configure Client Scopes for the Client**

<SwiperImageCarousel
  images={[
    { src: '/img/chapter3/screenshot_11PQUCpRN.png', alt: 'Screenshot 1' },
    { src: '/img/chapter3/screenshot_22HwS1pZR.png', alt: 'Screenshot 2' },
    { src: '/img/chapter3/screenshot_338RB0Gjh.png', alt: 'Screenshot 3' },
    { src: '/img/chapter3/screenshot_4455vRxK3.png', alt: 'Screenshot 4' },
    { src: '/img/chapter3/screenshot_55AbUWtKv.png', alt: 'Screenshot 5' },
  ]} />

**Spring Security**

<ShikiCodeBlock language="java" theme="catppuccin-frappe"
                source="https://raw.githubusercontent.com/stokilo/keycloack-docs/refs/heads/main/chapters/chapter3-custom-scopes/src/main/java/org/sstec/resourceserver/SecurityConfig.java" />

It looks for the realm_access.roles claim and scope claim (which is a space-separated string).

It prefixes realm roles with ROLE_ and scopes with SCOPE_. This is a common convention for Spring Security.

It also extracts client-specific roles from resource_access.client_id.roles and prefixes them (e.g., ROLE_CLIENT_). You might need to adjust the clientId if it's different or make it configurable.

**Application properties**

<ShikiCodeBlock language="properties" theme="catppuccin-frappe"
                source="https://raw.githubusercontent.com/stokilo/keycloack-docs/refs/heads/main/chapters/chapter3-custom-scopes/src/main/resources/application.properties" />


**Controller**
<ShikiCodeBlock language="java" theme="catppuccin-frappe"
                source="https://raw.githubusercontent.com/stokilo/keycloack-docs/refs/heads/main/chapters/chapter3-custom-scopes/src/main/java/org/sstec/resourceserver/HelloController.java" />

